# Python-to-SQL
# By: Jackie Horton, editted by Samuel Clear
# CS 195: Introduction to Databases

import sqlite3
import pandas as pd

# This shows all of the data that has been downloaded into the file!
def dump_data(cur):
    data = cur.execute("SELECT * from users;")
    for tup in data:
        print(tup)

# Conn is the current database file in SQL that will be edited by changes, while "cur" is the current changes that are being made!
conn = sqlite3.connect('climateChangeDatabase.db')
cur = conn.cursor()

# Other Data
cur.execute("DROP TABLE IF EXISTS users;")
cur.execute('''CREATE TABLE users('')''')
users = pd.read_csv("otherDataSets/loginCredentials.csv")
users.to_sql("users", conn, if_exists="replace", index = True, index_label="index_id")

cur.execute("DROP TABLE IF EXISTS petitions;")
cur.execute('''CREATE TABLE petitions('')''')
petitions = pd.read_csv("otherDataSets/petitionData.csv")
petitions.to_sql("petitions", conn, if_exists="replace", index = True, index_label="index_id")

# Tables for Glacier Density Data
cur.execute("DROP TABLE IF EXISTS glaciers;")
cur.execute('''CREATE TABLE glaciers('')''')
glaciers = pd.read_csv("glacierDensityDataSets/glacierDensityData.csv")
glaciers.to_sql("glaciers", conn, if_exists="replace", index = True, index_label="index_id")

# Tables for Global Warming Data
cur.execute("DROP TABLE IF EXISTS temperaturesCanada;")
cur.execute('''CREATE TABLE temperaturesCanada('')''')
temperaturesCanada = pd.read_csv("globalWarmingDataSets/averageTemperatureCanada.csv")
temperaturesCanada.to_sql("temperaturesCanada", conn, if_exists="replace", index = True, index_label="index_id")

cur.execute("DROP TABLE IF EXISTS temperaturesChile;")
cur.execute('''CREATE TABLE temperaturesChile('')''')
temperaturesChile = pd.read_csv("globalWarmingDataSets/averageTemperatureChile.csv")
temperaturesChile.to_sql("temperaturesChile", conn, if_exists="replace", index = True, index_label="index_id")

cur.execute("DROP TABLE IF EXISTS temperaturesGreenland;")
cur.execute('''CREATE TABLE temperaturesGreenland('')''')
temperaturesGreenland = pd.read_csv("globalWarmingDataSets/averageTemperatureGreenland.csv")
temperaturesGreenland.to_sql("temperaturesGreenland", conn, if_exists="replace", index = True, index_label="index_id")

cur.execute("DROP TABLE IF EXISTS temperaturesIceland;")
cur.execute('''CREATE TABLE temperaturesIceland('')''')
temperaturesIceland = pd.read_csv("globalWarmingDataSets/averageTemperatureIceland.csv")
temperaturesIceland.to_sql("temperaturesIceland", conn, if_exists="replace", index = True, index_label="index_id")

cur.execute("DROP TABLE IF EXISTS temperaturesPakistan;")
cur.execute('''CREATE TABLE temperaturesPakistan('')''')
temperaturesPakistan = pd.read_csv("globalWarmingDataSets/averageTemperaturePakistan.csv")
temperaturesPakistan.to_sql("temperaturesPakistan", conn, if_exists="replace", index = True, index_label="index_id")

cur.execute("DROP TABLE IF EXISTS temperaturesUnitedStatesOfAmerica;")
cur.execute('''CREATE TABLE temperaturesUnitedStatesOfAmerica('')''')
temperaturesUnitedStatesOfAmerica = pd.read_csv("globalWarmingDataSets/averageTemperatureUnitedStatesOfAmerica.csv")
temperaturesUnitedStatesOfAmerica.to_sql("temperaturesUnitedStatesOfAmerica", conn, if_exists="replace", index = True, index_label="index_id")

# Tables for Rising Sea Level Data
cur.execute("DROP TABLE IF EXISTS seaLevelCanada;")
cur.execute('''CREATE TABLE seaLevelCanada('')''')
seaLevelCanada = pd.read_csv("seaLevelDataSets/seaLevelCanadaDataset.csv")
seaLevelCanada.to_sql("seaLevelCanada", conn, if_exists="replace", index = True, index_label="index_id")

cur.execute("DROP TABLE IF EXISTS seaLevelChile;")
cur.execute('''CREATE TABLE seaLevelChile('')''')
seaLevelChile = pd.read_csv("seaLevelDataSets/seaLevelChileDataset.csv")
seaLevelChile.to_sql("seaLevelChile", conn, if_exists="replace", index = True, index_label="index_id")

cur.execute("DROP TABLE IF EXISTS seaLevelGreenland;")
cur.execute('''CREATE TABLE seaLevelGreenland('')''')
seaLevelGreenland = pd.read_csv("seaLevelDataSets/seaLevelGreenlandDataset.csv")
seaLevelGreenland.to_sql("seaLevelGreenland", conn, if_exists="replace", index = True, index_label="index_id")

cur.execute("DROP TABLE IF EXISTS seaLevelIceland;")
cur.execute('''CREATE TABLE seaLevelIceland('')''')
seaLevelIceland = pd.read_csv("seaLevelDataSets/seaLevelIcelandDataset.csv")
seaLevelIceland.to_sql("seaLevelIceland", conn, if_exists="replace", index = True, index_label="index_id")

cur.execute("DROP TABLE IF EXISTS seaLevelPakistan;")
cur.execute('''CREATE TABLE seaLevelPakistan('')''')
seaLevelPakistan = pd.read_csv("seaLevelDataSets/seaLevelPakistanDataset.csv")
seaLevelPakistan.to_sql("seaLevelPakistan", conn, if_exists="replace", index = True, index_label="index_id")

cur.execute("DROP TABLE IF EXISTS seaLevelUnitedStatesOfAmerica;")
cur.execute('''CREATE TABLE seaLevelUnitedStatesOfAmerica('')''')
seaLevelUnitedStatesOfAmerica = pd.read_csv("seaLevelDataSets/seaLevelUnitedStatesOfAmericaDataset.csv")
seaLevelUnitedStatesOfAmerica.to_sql("seaLevelUnitedStatesOfAmerica", conn, if_exists="replace", index = True, index_label="index_id")

# Commit all changes from the current databases brought into the program
conn.commit()
dump_data(cur)

# Change the "DateTime" Column of the data to a "Month" and "Year" column
cur.execute("ALTER TABLE seaLevelCanada ADD Month TEXT")
cur.execute("ALTER TABLE seaLevelCanada ADD Year INTEGER")
cur.execute("UPDATE seaLevelCanada SET Month = 'Jan' WHERE DateTime LIKE '%-Jan'")
cur.execute("UPDATE seaLevelCanada SET Month = 'Feb' WHERE DateTime LIKE '%-Feb'")
cur.execute("UPDATE seaLevelCanada SET Month = 'Mar' WHERE DateTime LIKE '%-Mar'")
cur.execute("UPDATE seaLevelCanada SET Month = 'Apr' WHERE DateTime LIKE '%-Apr'")
cur.execute("UPDATE seaLevelCanada SET Month = 'May' WHERE DateTime LIKE '%-May'")
cur.execute("UPDATE seaLevelCanada SET Month = 'Jun' WHERE DateTime LIKE '%-Jun'")
cur.execute("UPDATE seaLevelCanada SET Month = 'Jul' WHERE DateTime LIKE '%-Jul'")
cur.execute("UPDATE seaLevelCanada SET Month = 'Aug' WHERE DateTime LIKE '%-Aug'")
cur.execute("UPDATE seaLevelCanada SET Month = 'Sep' WHERE DateTime LIKE '%-Sep'")
cur.execute("UPDATE seaLevelCanada SET Month = 'Oct' WHERE DateTime LIKE '%-Oct'")
cur.execute("UPDATE seaLevelCanada SET Month = 'Nov' WHERE DateTime LIKE '%-Nov'")
cur.execute("UPDATE seaLevelCanada SET Month = 'Dec' WHERE DateTime LIKE '%-Dec'")
cur.execute("UPDATE seaLevelCanada SET Year = 1993 WHERE DateTime LIKE '1993%'")
cur.execute("UPDATE seaLevelCanada SET Year = 1994 WHERE DateTime LIKE '1994%'")
cur.execute("UPDATE seaLevelCanada SET Year = 1995 WHERE DateTime LIKE '1995%'")
cur.execute("UPDATE seaLevelCanada SET Year = 1996 WHERE DateTime LIKE '1996%'")
cur.execute("UPDATE seaLevelCanada SET Year = 1997 WHERE DateTime LIKE '1997%'")
cur.execute("UPDATE seaLevelCanada SET Year = 1998 WHERE DateTime LIKE '1998%'")
cur.execute("UPDATE seaLevelCanada SET Year = 1999 WHERE DateTime LIKE '1999%'")
cur.execute("UPDATE seaLevelCanada SET Year = 2000 WHERE DateTime LIKE '2000%'")
cur.execute("UPDATE seaLevelCanada SET Year = 2001 WHERE DateTime LIKE '2001%'")
cur.execute("UPDATE seaLevelCanada SET Year = 2002 WHERE DateTime LIKE '2002%'")
cur.execute("UPDATE seaLevelCanada SET Year = 2003 WHERE DateTime LIKE '2003%'")
cur.execute("UPDATE seaLevelCanada SET Year = 2004 WHERE DateTime LIKE '2004%'")
cur.execute("UPDATE seaLevelCanada SET Year = 2005 WHERE DateTime LIKE '2005%'")
cur.execute("UPDATE seaLevelCanada SET Year = 2006 WHERE DateTime LIKE '2006%'")
cur.execute("UPDATE seaLevelCanada SET Year = 2007 WHERE DateTime LIKE '2007%'")
cur.execute("UPDATE seaLevelCanada SET Year = 2008 WHERE DateTime LIKE '2008%'")
cur.execute("UPDATE seaLevelCanada SET Year = 2009 WHERE DateTime LIKE '2009%'")
cur.execute("UPDATE seaLevelCanada SET Year = 2010 WHERE DateTime LIKE '2010%'")
cur.execute("UPDATE seaLevelCanada SET Year = 2011 WHERE DateTime LIKE '2011%'")
cur.execute("UPDATE seaLevelCanada SET Year = 2012 WHERE DateTime LIKE '2012%'")
cur.execute("UPDATE seaLevelCanada SET Year = 2013 WHERE DateTime LIKE '2013%'")
cur.execute("UPDATE seaLevelCanada SET Year = 2014 WHERE DateTime LIKE '2014%'")
cur.execute("UPDATE seaLevelCanada SET Year = 2015 WHERE DateTime LIKE '2015%'")
cur.execute("CREATE TABLE seaLevelCanadaTwo AS SELECT index_id, Month, Year, Average_Monthly_Anomaly, Average_Annual_Anomaly FROM seaLevelCanada")
cur.execute("DROP TABLE seaLevelCanada")

cur.execute("ALTER TABLE seaLevelChile ADD Month TEXT")
cur.execute("ALTER TABLE seaLevelChile ADD Year INTEGER")
cur.execute("UPDATE seaLevelChile SET Month = 'Jan' WHERE DateTime LIKE '%-Jan'")
cur.execute("UPDATE seaLevelChile SET Month = 'Feb' WHERE DateTime LIKE '%-Feb'")
cur.execute("UPDATE seaLevelChile SET Month = 'Mar' WHERE DateTime LIKE '%-Mar'")
cur.execute("UPDATE seaLevelChile SET Month = 'Apr' WHERE DateTime LIKE '%-Apr'")
cur.execute("UPDATE seaLevelChile SET Month = 'May' WHERE DateTime LIKE '%-May'")
cur.execute("UPDATE seaLevelChile SET Month = 'Jun' WHERE DateTime LIKE '%-Jun'")
cur.execute("UPDATE seaLevelChile SET Month = 'Jul' WHERE DateTime LIKE '%-Jul'")
cur.execute("UPDATE seaLevelChile SET Month = 'Aug' WHERE DateTime LIKE '%-Aug'")
cur.execute("UPDATE seaLevelChile SET Month = 'Sep' WHERE DateTime LIKE '%-Sep'")
cur.execute("UPDATE seaLevelChile SET Month = 'Oct' WHERE DateTime LIKE '%-Oct'")
cur.execute("UPDATE seaLevelChile SET Month = 'Nov' WHERE DateTime LIKE '%-Nov'")
cur.execute("UPDATE seaLevelChile SET Month = 'Dec' WHERE DateTime LIKE '%-Dec'")
cur.execute("UPDATE seaLevelChile SET Year = 1993 WHERE DateTime LIKE '1993%'")
cur.execute("UPDATE seaLevelChile SET Year = 1994 WHERE DateTime LIKE '1994%'")
cur.execute("UPDATE seaLevelChile SET Year = 1995 WHERE DateTime LIKE '1995%'")
cur.execute("UPDATE seaLevelChile SET Year = 1996 WHERE DateTime LIKE '1996%'")
cur.execute("UPDATE seaLevelChile SET Year = 1997 WHERE DateTime LIKE '1997%'")
cur.execute("UPDATE seaLevelChile SET Year = 1998 WHERE DateTime LIKE '1998%'")
cur.execute("UPDATE seaLevelChile SET Year = 1999 WHERE DateTime LIKE '1999%'")
cur.execute("UPDATE seaLevelChile SET Year = 2000 WHERE DateTime LIKE '2000%'")
cur.execute("UPDATE seaLevelChile SET Year = 2001 WHERE DateTime LIKE '2001%'")
cur.execute("UPDATE seaLevelChile SET Year = 2002 WHERE DateTime LIKE '2002%'")
cur.execute("UPDATE seaLevelChile SET Year = 2003 WHERE DateTime LIKE '2003%'")
cur.execute("UPDATE seaLevelChile SET Year = 2004 WHERE DateTime LIKE '2004%'")
cur.execute("UPDATE seaLevelChile SET Year = 2005 WHERE DateTime LIKE '2005%'")
cur.execute("UPDATE seaLevelChile SET Year = 2006 WHERE DateTime LIKE '2006%'")
cur.execute("UPDATE seaLevelChile SET Year = 2007 WHERE DateTime LIKE '2007%'")
cur.execute("UPDATE seaLevelChile SET Year = 2008 WHERE DateTime LIKE '2008%'")
cur.execute("UPDATE seaLevelChile SET Year = 2009 WHERE DateTime LIKE '2009%'")
cur.execute("UPDATE seaLevelChile SET Year = 2010 WHERE DateTime LIKE '2010%'")
cur.execute("UPDATE seaLevelChile SET Year = 2011 WHERE DateTime LIKE '2011%'")
cur.execute("UPDATE seaLevelChile SET Year = 2012 WHERE DateTime LIKE '2012%'")
cur.execute("UPDATE seaLevelChile SET Year = 2013 WHERE DateTime LIKE '2013%'")
cur.execute("UPDATE seaLevelChile SET Year = 2014 WHERE DateTime LIKE '2014%'")
cur.execute("UPDATE seaLevelChile SET Year = 2015 WHERE DateTime LIKE '2015%'")
cur.execute("CREATE TABLE seaLevelChileTwo AS SELECT index_id, Month, Year, Average_Monthly_Anomaly, Average_Annual_Anomaly FROM seaLevelChile")
cur.execute("DROP TABLE seaLevelChile")

cur.execute("ALTER TABLE seaLevelGreenland ADD Month TEXT")
cur.execute("ALTER TABLE seaLevelGreenland ADD Year INTEGER")
cur.execute("UPDATE seaLevelGreenland SET Month = 'Jan' WHERE DateTime LIKE '%-Jan'")
cur.execute("UPDATE seaLevelGreenland SET Month = 'Feb' WHERE DateTime LIKE '%-Feb'")
cur.execute("UPDATE seaLevelGreenland SET Month = 'Mar' WHERE DateTime LIKE '%-Mar'")
cur.execute("UPDATE seaLevelGreenland SET Month = 'Apr' WHERE DateTime LIKE '%-Apr'")
cur.execute("UPDATE seaLevelGreenland SET Month = 'May' WHERE DateTime LIKE '%-May'")
cur.execute("UPDATE seaLevelGreenland SET Month = 'Jun' WHERE DateTime LIKE '%-Jun'")
cur.execute("UPDATE seaLevelGreenland SET Month = 'Jul' WHERE DateTime LIKE '%-Jul'")
cur.execute("UPDATE seaLevelGreenland SET Month = 'Aug' WHERE DateTime LIKE '%-Aug'")
cur.execute("UPDATE seaLevelGreenland SET Month = 'Sep' WHERE DateTime LIKE '%-Sep'")
cur.execute("UPDATE seaLevelGreenland SET Month = 'Oct' WHERE DateTime LIKE '%-Oct'")
cur.execute("UPDATE seaLevelGreenland SET Month = 'Nov' WHERE DateTime LIKE '%-Nov'")
cur.execute("UPDATE seaLevelGreenland SET Month = 'Dec' WHERE DateTime LIKE '%-Dec'")
cur.execute("UPDATE seaLevelGreenland SET Year = 1993 WHERE DateTime LIKE '1993%'")
cur.execute("UPDATE seaLevelGreenland SET Year = 1994 WHERE DateTime LIKE '1994%'")
cur.execute("UPDATE seaLevelGreenland SET Year = 1995 WHERE DateTime LIKE '1995%'")
cur.execute("UPDATE seaLevelGreenland SET Year = 1996 WHERE DateTime LIKE '1996%'")
cur.execute("UPDATE seaLevelGreenland SET Year = 1997 WHERE DateTime LIKE '1997%'")
cur.execute("UPDATE seaLevelGreenland SET Year = 1998 WHERE DateTime LIKE '1998%'")
cur.execute("UPDATE seaLevelGreenland SET Year = 1999 WHERE DateTime LIKE '1999%'")
cur.execute("UPDATE seaLevelGreenland SET Year = 2000 WHERE DateTime LIKE '2000%'")
cur.execute("UPDATE seaLevelGreenland SET Year = 2001 WHERE DateTime LIKE '2001%'")
cur.execute("UPDATE seaLevelGreenland SET Year = 2002 WHERE DateTime LIKE '2002%'")
cur.execute("UPDATE seaLevelGreenland SET Year = 2003 WHERE DateTime LIKE '2003%'")
cur.execute("UPDATE seaLevelGreenland SET Year = 2004 WHERE DateTime LIKE '2004%'")
cur.execute("UPDATE seaLevelGreenland SET Year = 2005 WHERE DateTime LIKE '2005%'")
cur.execute("UPDATE seaLevelGreenland SET Year = 2006 WHERE DateTime LIKE '2006%'")
cur.execute("UPDATE seaLevelGreenland SET Year = 2007 WHERE DateTime LIKE '2007%'")
cur.execute("UPDATE seaLevelGreenland SET Year = 2008 WHERE DateTime LIKE '2008%'")
cur.execute("UPDATE seaLevelGreenland SET Year = 2009 WHERE DateTime LIKE '2009%'")
cur.execute("UPDATE seaLevelGreenland SET Year = 2010 WHERE DateTime LIKE '2010%'")
cur.execute("UPDATE seaLevelGreenland SET Year = 2011 WHERE DateTime LIKE '2011%'")
cur.execute("UPDATE seaLevelGreenland SET Year = 2012 WHERE DateTime LIKE '2012%'")
cur.execute("UPDATE seaLevelGreenland SET Year = 2013 WHERE DateTime LIKE '2013%'")
cur.execute("UPDATE seaLevelGreenland SET Year = 2014 WHERE DateTime LIKE '2014%'")
cur.execute("UPDATE seaLevelGreenland SET Year = 2015 WHERE DateTime LIKE '2015%'")
cur.execute("CREATE TABLE seaLevelGreenlandTwo AS SELECT index_id, Month, Year, Average_Monthly_Anomaly, Average_Annual_Anomaly FROM seaLevelGreenland")
cur.execute("DROP TABLE seaLevelGreenland")

cur.execute("ALTER TABLE seaLevelIceland ADD Month TEXT")
cur.execute("ALTER TABLE seaLevelIceland ADD Year INTEGER")
cur.execute("UPDATE seaLevelIceland SET Month = 'Jan' WHERE DateTime LIKE '%-Jan'")
cur.execute("UPDATE seaLevelIceland SET Month = 'Feb' WHERE DateTime LIKE '%-Feb'")
cur.execute("UPDATE seaLevelIceland SET Month = 'Mar' WHERE DateTime LIKE '%-Mar'")
cur.execute("UPDATE seaLevelIceland SET Month = 'Apr' WHERE DateTime LIKE '%-Apr'")
cur.execute("UPDATE seaLevelIceland SET Month = 'May' WHERE DateTime LIKE '%-May'")
cur.execute("UPDATE seaLevelIceland SET Month = 'Jun' WHERE DateTime LIKE '%-Jun'")
cur.execute("UPDATE seaLevelIceland SET Month = 'Jul' WHERE DateTime LIKE '%-Jul'")
cur.execute("UPDATE seaLevelIceland SET Month = 'Aug' WHERE DateTime LIKE '%-Aug'")
cur.execute("UPDATE seaLevelIceland SET Month = 'Sep' WHERE DateTime LIKE '%-Sep'")
cur.execute("UPDATE seaLevelIceland SET Month = 'Oct' WHERE DateTime LIKE '%-Oct'")
cur.execute("UPDATE seaLevelIceland SET Month = 'Nov' WHERE DateTime LIKE '%-Nov'")
cur.execute("UPDATE seaLevelIceland SET Month = 'Dec' WHERE DateTime LIKE '%-Dec'")
cur.execute("UPDATE seaLevelIceland SET Year = 1993 WHERE DateTime LIKE '1993%'")
cur.execute("UPDATE seaLevelIceland SET Year = 1994 WHERE DateTime LIKE '1994%'")
cur.execute("UPDATE seaLevelIceland SET Year = 1995 WHERE DateTime LIKE '1995%'")
cur.execute("UPDATE seaLevelIceland SET Year = 1996 WHERE DateTime LIKE '1996%'")
cur.execute("UPDATE seaLevelIceland SET Year = 1997 WHERE DateTime LIKE '1997%'")
cur.execute("UPDATE seaLevelIceland SET Year = 1998 WHERE DateTime LIKE '1998%'")
cur.execute("UPDATE seaLevelIceland SET Year = 1999 WHERE DateTime LIKE '1999%'")
cur.execute("UPDATE seaLevelIceland SET Year = 2000 WHERE DateTime LIKE '2000%'")
cur.execute("UPDATE seaLevelIceland SET Year = 2001 WHERE DateTime LIKE '2001%'")
cur.execute("UPDATE seaLevelIceland SET Year = 2002 WHERE DateTime LIKE '2002%'")
cur.execute("UPDATE seaLevelIceland SET Year = 2003 WHERE DateTime LIKE '2003%'")
cur.execute("UPDATE seaLevelIceland SET Year = 2004 WHERE DateTime LIKE '2004%'")
cur.execute("UPDATE seaLevelIceland SET Year = 2005 WHERE DateTime LIKE '2005%'")
cur.execute("UPDATE seaLevelIceland SET Year = 2006 WHERE DateTime LIKE '2006%'")
cur.execute("UPDATE seaLevelIceland SET Year = 2007 WHERE DateTime LIKE '2007%'")
cur.execute("UPDATE seaLevelIceland SET Year = 2008 WHERE DateTime LIKE '2008%'")
cur.execute("UPDATE seaLevelIceland SET Year = 2009 WHERE DateTime LIKE '2009%'")
cur.execute("UPDATE seaLevelIceland SET Year = 2010 WHERE DateTime LIKE '2010%'")
cur.execute("UPDATE seaLevelIceland SET Year = 2011 WHERE DateTime LIKE '2011%'")
cur.execute("UPDATE seaLevelIceland SET Year = 2012 WHERE DateTime LIKE '2012%'")
cur.execute("UPDATE seaLevelIceland SET Year = 2013 WHERE DateTime LIKE '2013%'")
cur.execute("UPDATE seaLevelIceland SET Year = 2014 WHERE DateTime LIKE '2014%'")
cur.execute("UPDATE seaLevelIceland SET Year = 2015 WHERE DateTime LIKE '2015%'")
cur.execute("CREATE TABLE seaLevelIcelandTwo AS SELECT index_id, Month, Year, Average_Monthly_Anomaly, Average_Annual_Anomaly FROM seaLevelIceland")
cur.execute("DROP TABLE seaLevelIceland")

cur.execute("ALTER TABLE seaLevelPakistan ADD Month TEXT")
cur.execute("ALTER TABLE seaLevelPakistan ADD Year INTEGER")
cur.execute("UPDATE seaLevelPakistan SET Month = 'Jan' WHERE DateTime LIKE '%-Jan'")
cur.execute("UPDATE seaLevelPakistan SET Month = 'Feb' WHERE DateTime LIKE '%-Feb'")
cur.execute("UPDATE seaLevelPakistan SET Month = 'Mar' WHERE DateTime LIKE '%-Mar'")
cur.execute("UPDATE seaLevelPakistan SET Month = 'Apr' WHERE DateTime LIKE '%-Apr'")
cur.execute("UPDATE seaLevelPakistan SET Month = 'May' WHERE DateTime LIKE '%-May'")
cur.execute("UPDATE seaLevelPakistan SET Month = 'Jun' WHERE DateTime LIKE '%-Jun'")
cur.execute("UPDATE seaLevelPakistan SET Month = 'Jul' WHERE DateTime LIKE '%-Jul'")
cur.execute("UPDATE seaLevelPakistan SET Month = 'Aug' WHERE DateTime LIKE '%-Aug'")
cur.execute("UPDATE seaLevelPakistan SET Month = 'Sep' WHERE DateTime LIKE '%-Sep'")
cur.execute("UPDATE seaLevelPakistan SET Month = 'Oct' WHERE DateTime LIKE '%-Oct'")
cur.execute("UPDATE seaLevelPakistan SET Month = 'Nov' WHERE DateTime LIKE '%-Nov'")
cur.execute("UPDATE seaLevelPakistan SET Month = 'Dec' WHERE DateTime LIKE '%-Dec'")
cur.execute("UPDATE seaLevelPakistan SET Year = 1993 WHERE DateTime LIKE '1993%'")
cur.execute("UPDATE seaLevelPakistan SET Year = 1994 WHERE DateTime LIKE '1994%'")
cur.execute("UPDATE seaLevelPakistan SET Year = 1995 WHERE DateTime LIKE '1995%'")
cur.execute("UPDATE seaLevelPakistan SET Year = 1996 WHERE DateTime LIKE '1996%'")
cur.execute("UPDATE seaLevelPakistan SET Year = 1997 WHERE DateTime LIKE '1997%'")
cur.execute("UPDATE seaLevelPakistan SET Year = 1998 WHERE DateTime LIKE '1998%'")
cur.execute("UPDATE seaLevelPakistan SET Year = 1999 WHERE DateTime LIKE '1999%'")
cur.execute("UPDATE seaLevelPakistan SET Year = 2000 WHERE DateTime LIKE '2000%'")
cur.execute("UPDATE seaLevelPakistan SET Year = 2001 WHERE DateTime LIKE '2001%'")
cur.execute("UPDATE seaLevelPakistan SET Year = 2002 WHERE DateTime LIKE '2002%'")
cur.execute("UPDATE seaLevelPakistan SET Year = 2003 WHERE DateTime LIKE '2003%'")
cur.execute("UPDATE seaLevelPakistan SET Year = 2004 WHERE DateTime LIKE '2004%'")
cur.execute("UPDATE seaLevelPakistan SET Year = 2005 WHERE DateTime LIKE '2005%'")
cur.execute("UPDATE seaLevelPakistan SET Year = 2006 WHERE DateTime LIKE '2006%'")
cur.execute("UPDATE seaLevelPakistan SET Year = 2007 WHERE DateTime LIKE '2007%'")
cur.execute("UPDATE seaLevelPakistan SET Year = 2008 WHERE DateTime LIKE '2008%'")
cur.execute("UPDATE seaLevelPakistan SET Year = 2009 WHERE DateTime LIKE '2009%'")
cur.execute("UPDATE seaLevelPakistan SET Year = 2010 WHERE DateTime LIKE '2010%'")
cur.execute("UPDATE seaLevelPakistan SET Year = 2011 WHERE DateTime LIKE '2011%'")
cur.execute("UPDATE seaLevelPakistan SET Year = 2012 WHERE DateTime LIKE '2012%'")
cur.execute("UPDATE seaLevelPakistan SET Year = 2013 WHERE DateTime LIKE '2013%'")
cur.execute("UPDATE seaLevelPakistan SET Year = 2014 WHERE DateTime LIKE '2014%'")
cur.execute("UPDATE seaLevelPakistan SET Year = 2015 WHERE DateTime LIKE '2015%'")
cur.execute("CREATE TABLE seaLevelPakistanTwo AS SELECT index_id, Month, Year, Average_Monthly_Anomaly, Average_Annual_Anomaly FROM seaLevelPakistan")
cur.execute("DROP TABLE seaLevelPakistan")

cur.execute("ALTER TABLE seaLevelUnitedStatesOfAmerica ADD Month TEXT")
cur.execute("ALTER TABLE seaLevelUnitedStatesOfAmerica ADD Year INTEGER")
cur.execute("UPDATE seaLevelUnitedStatesOfAmerica SET Month = 'Jan' WHERE DateTime LIKE '%-Jan'")
cur.execute("UPDATE seaLevelUnitedStatesOfAmerica SET Month = 'Feb' WHERE DateTime LIKE '%-Feb'")
cur.execute("UPDATE seaLevelUnitedStatesOfAmerica SET Month = 'Mar' WHERE DateTime LIKE '%-Mar'")
cur.execute("UPDATE seaLevelUnitedStatesOfAmerica SET Month = 'Apr' WHERE DateTime LIKE '%-Apr'")
cur.execute("UPDATE seaLevelUnitedStatesOfAmerica SET Month = 'May' WHERE DateTime LIKE '%-May'")
cur.execute("UPDATE seaLevelUnitedStatesOfAmerica SET Month = 'Jun' WHERE DateTime LIKE '%-Jun'")
cur.execute("UPDATE seaLevelUnitedStatesOfAmerica SET Month = 'Jul' WHERE DateTime LIKE '%-Jul'")
cur.execute("UPDATE seaLevelUnitedStatesOfAmerica SET Month = 'Aug' WHERE DateTime LIKE '%-Aug'")
cur.execute("UPDATE seaLevelUnitedStatesOfAmerica SET Month = 'Sep' WHERE DateTime LIKE '%-Sep'")
cur.execute("UPDATE seaLevelUnitedStatesOfAmerica SET Month = 'Oct' WHERE DateTime LIKE '%-Oct'")
cur.execute("UPDATE seaLevelUnitedStatesOfAmerica SET Month = 'Nov' WHERE DateTime LIKE '%-Nov'")
cur.execute("UPDATE seaLevelUnitedStatesOfAmerica SET Month = 'Dec' WHERE DateTime LIKE '%-Dec'")
cur.execute("UPDATE seaLevelUnitedStatesOfAmerica SET Year = 1993 WHERE DateTime LIKE '1993%'")
cur.execute("UPDATE seaLevelUnitedStatesOfAmerica SET Year = 1994 WHERE DateTime LIKE '1994%'")
cur.execute("UPDATE seaLevelUnitedStatesOfAmerica SET Year = 1995 WHERE DateTime LIKE '1995%'")
cur.execute("UPDATE seaLevelUnitedStatesOfAmerica SET Year = 1996 WHERE DateTime LIKE '1996%'")
cur.execute("UPDATE seaLevelUnitedStatesOfAmerica SET Year = 1997 WHERE DateTime LIKE '1997%'")
cur.execute("UPDATE seaLevelUnitedStatesOfAmerica SET Year = 1998 WHERE DateTime LIKE '1998%'")
cur.execute("UPDATE seaLevelUnitedStatesOfAmerica SET Year = 1999 WHERE DateTime LIKE '1999%'")
cur.execute("UPDATE seaLevelUnitedStatesOfAmerica SET Year = 2000 WHERE DateTime LIKE '2000%'")
cur.execute("UPDATE seaLevelUnitedStatesOfAmerica SET Year = 2001 WHERE DateTime LIKE '2001%'")
cur.execute("UPDATE seaLevelUnitedStatesOfAmerica SET Year = 2002 WHERE DateTime LIKE '2002%'")
cur.execute("UPDATE seaLevelUnitedStatesOfAmerica SET Year = 2003 WHERE DateTime LIKE '2003%'")
cur.execute("UPDATE seaLevelUnitedStatesOfAmerica SET Year = 2004 WHERE DateTime LIKE '2004%'")
cur.execute("UPDATE seaLevelUnitedStatesOfAmerica SET Year = 2005 WHERE DateTime LIKE '2005%'")
cur.execute("UPDATE seaLevelUnitedStatesOfAmerica SET Year = 2006 WHERE DateTime LIKE '2006%'")
cur.execute("UPDATE seaLevelUnitedStatesOfAmerica SET Year = 2007 WHERE DateTime LIKE '2007%'")
cur.execute("UPDATE seaLevelUnitedStatesOfAmerica SET Year = 2008 WHERE DateTime LIKE '2008%'")
cur.execute("UPDATE seaLevelUnitedStatesOfAmerica SET Year = 2009 WHERE DateTime LIKE '2009%'")
cur.execute("UPDATE seaLevelUnitedStatesOfAmerica SET Year = 2010 WHERE DateTime LIKE '2010%'")
cur.execute("UPDATE seaLevelUnitedStatesOfAmerica SET Year = 2011 WHERE DateTime LIKE '2011%'")
cur.execute("UPDATE seaLevelUnitedStatesOfAmerica SET Year = 2012 WHERE DateTime LIKE '2012%'")
cur.execute("UPDATE seaLevelUnitedStatesOfAmerica SET Year = 2013 WHERE DateTime LIKE '2013%'")
cur.execute("UPDATE seaLevelUnitedStatesOfAmerica SET Year = 2014 WHERE DateTime LIKE '2014%'")
cur.execute("UPDATE seaLevelUnitedStatesOfAmerica SET Year = 2015 WHERE DateTime LIKE '2015%'")
cur.execute("CREATE TABLE seaLevelUnitedStatesOfAmericaTwo AS SELECT index_id, Month, Year, Average_Monthly_Anomaly, Average_Annual_Anomaly FROM seaLevelUnitedStatesOfAmerica")
cur.execute("DROP TABLE seaLevelUnitedStatesOfAmerica")

conn.commit()
dump_data(cur)

# Rename "Category" Column to "Year"
cur.execute("ALTER TABLE temperaturesCanada ADD Year INTEGER")
cur.execute("UPDATE temperaturesCanada SET Year = Category")
cur.execute("CREATE TABLE temperaturesCanadaTwo AS SELECT index_id, Year, Annual_Mean, Five_Year_Smooth FROM temperaturesCanada")
cur.execute("DROP TABLE temperaturesCanada")

cur.execute("ALTER TABLE temperaturesChile ADD Year INTEGER")
cur.execute("UPDATE temperaturesChile SET Year = Category")
cur.execute("CREATE TABLE temperaturesChileTwo AS SELECT index_id, Year, Annual_Mean, Five_Year_Smooth FROM temperaturesChile")
cur.execute("DROP TABLE temperaturesChile")

cur.execute("ALTER TABLE temperaturesGreenland ADD Year INTEGER")
cur.execute("UPDATE temperaturesGreenland SET Year = Category")
cur.execute("CREATE TABLE temperaturesGreenlandTwo AS SELECT index_id, Year, Annual_Mean, Five_Year_Smooth FROM temperaturesGreenland")
cur.execute("DROP TABLE temperaturesGreenland")

cur.execute("ALTER TABLE temperaturesIceland ADD Year INTEGER")
cur.execute("UPDATE temperaturesIceland SET Year = Category")
cur.execute("CREATE TABLE temperaturesIcelandTwo AS SELECT index_id, Year, Annual_Mean, Five_Year_Smooth FROM temperaturesIceland")
cur.execute("DROP TABLE temperaturesIceland")

cur.execute("ALTER TABLE temperaturesPakistan ADD Year INTEGER")
cur.execute("UPDATE temperaturesPakistan SET Year = Category")
cur.execute("CREATE TABLE temperaturesPakistanTwo AS SELECT index_id, Year, Annual_Mean, Five_Year_Smooth FROM temperaturesPakistan")
cur.execute("DROP TABLE temperaturesPakistan")

cur.execute("ALTER TABLE temperaturesUnitedStatesOfAmerica ADD Year INTEGER")
cur.execute("UPDATE temperaturesUnitedStatesOfAmerica SET Year = Category")
cur.execute("CREATE TABLE temperaturesUnitedStatesOfAmericaTwo AS SELECT index_id, Year, Annual_Mean, Five_Year_Smooth FROM temperaturesUnitedStatesOfAmerica")
cur.execute("DROP TABLE temperaturesUnitedStatesOfAmerica")

conn.commit()
dump_data(cur)